@model ShopLyraAPP.Models.ProductCategory

@{
    ViewBag.Title = "AddOrUpdateCategory";
    Layout = "~/Views/Shared/_AdminLayoutPage.cshtml";
}



<form action="/ProductCategories/AddOrUpdateCategory" method="post" id="formData" enctype="multipart/form-data">

    <div class="form-horizontal">

        @if (Model != null)
        {
            if (Model.ID > 0)
            {
                <h2 id="title">Sửa thông tin loại sản phẩm</h2>
                @Html.HiddenFor(model => model.ID)
            }
            else
            {
                <h2 id="title">Thêm loại sản phẩm</h2>
            }
        }
        else
        {
            <h2 id="title">Thêm loại sản phẩm</h2>
        }
        <hr />
        <div class="form-group">
            @Html.LabelFor(model => model.Name, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.Name, new { htmlAttributes = new { @class = "form-control" } })
            </div>
        </div>

        @*<div class="form-group">
            @Html.LabelFor(model => model.MetaTitle, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.MetaTitle, new { htmlAttributes = new { @class = "form-control" } })
            </div>
        </div>*@

        <div class="form-group">
            @Html.LabelFor(model => model.DisplayOrder, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.DisplayOrder, new { htmlAttributes = new { @class = "form-control" } })
            </div>
        </div>

        @*<div class="form-group">
            @Html.LabelFor(model => model.SeoTitle, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.SeoTitle, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.SeoTitle, "", new { @class = "text-danger" })
            </div>
        </div>*@

        <div class="row">
            @ViewBag.ThongBao
            <div class="col-sm-12 col-md-6">
                <div class="form-group">
                    @Html.LabelFor(model => model.Image, htmlAttributes: new { @class = "control-label col-md" })
                    <div class="col-md-12">
                        <input class="mt-3" type="file" name="Image" id="Image" onchange="loadFile(event)" /> 
                        <div id="images-group">
                            <div class="row no-gutters">
                                @if (Model != null)
                                {
                                    <div class="multiple-images-wrapper col-md-5">
                                        <img src="~/images/productCategories/@Model.Image" class="multipleImage img-thumbnail" />
                                        <a href="javascript:;" id="0" class="btn btn-outline-dark" onclick="delImage(@Model.ID)">
                                            <span>x</span>
                                        </a>
                                    </div>
                                }
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-12 col-md-6">
                <div class="form-group">
                    @Html.LabelFor(model => model.Logo, htmlAttributes: new { @class = "control-label col-md" })
                    <div class="col-md-12">
                        <input class="mt-3" type="file" name="Logo" id="Logo" onchange="loadLogo(event)" /> 
                        <div id="logo-group">
                            <div class="row no-gutters">
                                @if (Model != null)
                                {
                                    <div class="multiple-images-wrapper col-md-5">
                                        <img src="~/images/productCategories/@Model.Logo" class="multipleImage img-thumbnail" />
                                        <a href="javascript:;" id="1" class="btn btn-outline-dark" onclick="delLogo(@Model.ID)">
                                            <span>x</span>
                                        </a>
                                    </div>
                                }
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

       

        

        @if (Model == null)
        {
            <div class="form-group">
                @Html.LabelFor(model => model.CreateDate, htmlAttributes: new { @class = "control-label col-md-2" })
                <div class="col-md-10">
                    @Html.EditorFor(model => model.CreateDate, new { htmlAttributes = new { @class = "form-control" } })
                </div>
            </div>
        }
        else
        {
            if (Model.ID == 0)
            {
                <div class="form-group">
                    @Html.LabelFor(model => model.CreateDate, htmlAttributes: new { @class = "control-label col-md-2" })
                    <div class="col-md-10">
                        @Html.EditorFor(model => model.CreateDate, new { htmlAttributes = new { @class = "form-control" } })
                    </div>
                </div>
            }
            else
            {
                <div class="form-group disabled">
                    @Html.LabelFor(model => model.CreateDate, htmlAttributes: new { @class = "control-label col-md-2" })
                    <div class="col-md-10">
                        @Html.EditorFor(model => model.CreateDate, new { htmlAttributes = new { @class = "form-control" } })
                    </div>
                </div>
            }
        }

        <div class="form-group">
            @Html.LabelFor(model => model.CreateBy, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.CreateBy, new { htmlAttributes = new { @class = "form-control" } })
            </div>
        </div>
        @if (Model != null)
        {
            if (Model.ID > 0)
            {
                <div class="form-group">
                    @Html.LabelFor(model => model.Modifiledate, htmlAttributes: new { @class = "control-label col-md-2" })
                    <div class="col-md-10">
                        @Html.EditorFor(model => model.Modifiledate, new { htmlAttributes = new { @class = "form-control" } })
                    </div>
                </div>
                <div class="form-group">
                    @Html.LabelFor(model => model.ModifileBy, htmlAttributes: new { @class = "control-label col-md-2" })
                    <div class="col-md-10">
                        @Html.EditorFor(model => model.ModifileBy, new { htmlAttributes = new { @class = "form-control" } })
                        @Html.ValidationMessageFor(model => model.ModifileBy, "", new { @class = "text-danger" })
                    </div>
                </div>
            }
        }
            <div class="row">
                <div class="col-sm-12 col-md-5">
                    <div class="form-group">
                        @Html.LabelFor(model => model.Active, htmlAttributes: new { @class = "control-label col-md" })
                        <div class="col-md-12">
                            @Html.EditorFor(model => model.Active, new { htmlAttributes = new { @class = "form-control" } })
                        </div>
                    </div>
                </div>
                <div class="col-sm-12 col-md-5">
                    <div class="form-group">
                        @Html.LabelFor(model => model.ShowOnHome, htmlAttributes: new { @class = "control-label col-md" })
                        <div class="col-md-12">
                            @Html.EditorFor(model => model.ShowOnHome, new { htmlAttributes = new { @class = "form-control" } })
                        </div>
                    </div>
                </div>
            </div>
        

        
        @* footer form *@
        <hr />
        <div class="form-group">
            @if (Model != null)
            {
                if (Model.ID > 0)
                {
                    <button type="submit" id="btnSubmit" class="btn btn-success btn-lg">
                        <i class="far fa-pen-square mr-1"></i> Lưu thay đổi
                    </button>
                }
                else
                {
                    <button type="submit" class="btn btn-success btn-lg">
                        <i class="far fa-plus mr-1"></i> Thêm mới
                    </button>
                }
            }
            else
            {
                <button type="submit" class="btn btn-success btn-lg">
                    <i class="far fa-plus mr-1"></i> Thêm mới
                </button>
            }
        </div>
    </div>
</form>

<div>
    <a href="/ProductCategories/Index" class="btn btn-outline-info">Quay lại</a>
</div>
<style>
    /*#ModifileCustomer, #modifileDate {
        display: none;
    }
    #ModifileCustomer.Active, #modifileDate.Active{
        display: block;
    }
    #CreateDateA.display {
        display: none;
    }*/
    #images-group .multipleImage, #logo-group .multipleImage { 
        height: 180px;
        object-fit: cover;
    }

    #images-group .multiple-images-wrapper a,
    #logo-group .multiple-images-wrapper a {
        position: absolute;
        top: 0;
        right: 0;
        padding: 1px 6px;
        font-size: 10px;
    }
</style>


@section scripts{
    <script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.2/dist/jquery.validate.min.js" type="text/javascript"></script>
    <script>
        //if ($("#ID").val() > 0) {
        //    $("#title").html("Sửa Loại sản phẩm");
        //    $("#btnSubmit").html("Lưu thay đổi");
        //    $("#CreateDateA").addClass("display");
        //    $("#ModifileCustomer").addClass("Active");
        //    $("#modifileDate").addClass("Active");
        //}
        //else {
        //    $("#ID").val(0)
        //    $("#title").html("Thêm loại sản phẩm mới");
        //    $("#btnSubmit").html("Thêm");
        //}
        function loadFile(event) {
            var files = event.target.files;
            var acceptFileTypes = /^image\/(gif|jpe?g|png|svg)$/i;
            for (var i = 0; i < files.length; i++) {
                if (files[0]["type"].length && !acceptFileTypes.test(files[0]["type"])) {
                    alert("Chỉ chấp nhận định dạng jpeg, jpg, png, gif,svg");
                    return false;
                }
                if (files[0]["size"] > 4000000) {
                    alert("Dung lượng ảnh lớn hơn 4MB");
                    return false;
                }
                $("#images-group .row").html('<div class="multiple-images-wrapper col-md-4"><img src="' + URL.createObjectURL(event.target.files[0]) + '" class="multipleImage img-thumbnail" /><a href="javascript:;" id="0" class="btn btn-outline-dark" onclick="deleteImage(' + 0 + ')"><span>x</span></a></div>');
            }
        }
        function loadLogo(event) {
            var files = event.target.files;
            var acceptFileTypes = /^image\/(gif|jpe?g|png|svg)$/i;
            for (var i = 0; i < files.length; i++) {
                if (files[0]["type"].length && !acceptFileTypes.test(files[0]["type"])) {
                    alert("Chỉ chấp nhận định dạng jpeg, jpg, png, gif,svg");
                    return false;
                }
                if (files[0]["size"] > 4000000) {
                    alert("Dung lượng ảnh lớn hơn 4MB");
                    return false;
                }
                $("#logo-group .row").html('<div class="multiple-images-wrapper col-md-4"><img src="' + URL.createObjectURL(event.target.files[0]) + '" class="multipleImage img-thumbnail" /><a href="javascript:;" id="1" class="btn btn-outline-dark" onclick="deleteImage(' + 1 + ')"><span>x</span></a></div>');
            }
        }
        function deleteImage(divid) {
            if (confirm('Bạn có chắc xóa ảnh này?')) {
                $('#' + divid).parent().fadeOut().remove();
            }
        }
        function delImage(imgID) {
            if (confirm("bạn có chắc chắn muốn xóa ảnh này không?")) {
                $.ajax({
                    type: "post",
                    url: "/ProductCategories/DeleteImage",
                    data: { id: imgID },
                    success: function (res) {
                        if (res) {
                            alert("Xóa thành công");
                            $('#0').parent().fadeOut().remove();
                        }
                        else {
                            alert("Lỗi !");
                        }
                    },
                    error: function (er) {
                        alert(er+"aaaaa");
                    }
                })
            }
        }
        function delLogo(logoID) {
            if (confirm("bạn có chắc chắn muốn xóa ảnh này không?")) {
                $.ajax({
                    type: "post",
                    url: "/ProductCategories/DeleteLogo",
                    data: { id: logoID },
                    success: function (res) {
                        if (res) {
                            alert("Xóa thành công");
                            $('#1').parent().fadeOut().remove();
                        }
                        else {
                            alert("lỗi!!");
                        }
                    },
                    error: function (er) {
                        alert("lỗi!");
                    }
                })
            }
        }


    </script>
}